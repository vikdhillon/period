<html>
<head>
<title>PERIOD user manual</title>
<link rel=stylesheet href="period.css" type="text/css">
</head>
<body>

<p>
<h1>PERIOD: A time-series analysis package</h1>
</p>

<h2>Vik Dhillon, 27 June 2014</h2>

<hr noshade>

<p>
<ol>
<li><a href="#Introduction">Introduction</a>
<li><a href="#Installation">Installation</a>
<li><a href="#Initializing and running">Initializing and running</a>
<li><a href="#Data format and storage">Data format and storage</a>
<li><a href="#Menu options">Menu options</a>
<li><a href="#A simple recipe">A simple recipe</a>
<li><a href="#References">References</a>
</ol>
</p>

<!------------------------------------------------------------------------->

<hr noshade>
<a name="Introduction">
<h2>Introduction</h2>

<p>
PERIOD is a software package designed to search for periodicities
in data.  I originally released the program to <a
 href=http://www.starlink.ac.uk>Starlink</a> for distribution in 1993
(v3.0-v4.0). In 1995, Grant Privett (Starlink) ported PERIOD from VMS
to unix (v4.1), and in 1997 to linux (v4.2). Then, in 2003, PERIOD was
converted by Martin Bly (Starlink) to handle double precision data
(v5.0). The Starlink version lost the QDP/PLT plotting/fitting
capability, unfortunately, and remains more or less unchanged in
functionality since 1995. 
</p>

<p>
The development of <a
 href=http://www.shef.ac.uk/~phys/people/vdhillon/ultracam>ULTRACAM</a>
prompted me to convert my original VMS version (v4.0) to linux in
2002, including the QDP/PLT capability, and adding functionality to
process the log files output by Tom Marsh's ULTRACAM <a
 href=http://www.astro.soton.ac.uk/~trm/>pipeline data reduction
software</a>. I also converted period entirely into double precision.
This "native" version of period is now unrecognisable from the
 Starlink version, with more than double the number of options for
manipulating and viewing data, and for finding periods in it. The
latest version is v10.0. The software is available on request,
primarily to my research collaborators as I can only support it
on a best-efforts basis (i.e. please feel free to send any bug reports
or enhancement requests to me, but don't expect me to act on them in a
timely manner).
</p>

<!------------------------------------------------------------------------->

<hr noshade>
<a name="Installation">
<h2>Installation</h2>

To install PERIOD:

<p>
<ol>

<li>Download the gzipped tar file <a
href=period_v6.0.tar.gz><em>period_v6.0.tar.gz</em></a>

<li>Unpack the software by typing:
<p><ul><li>tar xvfz period_v6.0.tar.gz</ul></p>
A directory named <em>period</em> will be created, containing
sub-directories <em>bin</em> (containing the period executable and the
startup script <em>period_start</em>), <em>doc</em> (containing this
user manual), <em>hlp</em> (containing the program's help files) and
<em>src</em> (containing the f77 source files).

<li>Download <em>common5.2linux_pc.tar.gz</em> from <a
href=ftp://legacy.gsfc.nasa.gov/software/lheasoft/lheasoft52/binaries/linux_pc/>ftp://legacy.gsfc.nasa.gov/software/lheasoft/lheasoft52/binaries/linux_pc</a>. This
is a minimal set of the <a href=http://www.xanadu.com>XANADU</a> X-ray data 
analysis software provided by <a href=http://www.heasarc.com>NASA/HEASARC</a> 
which contains <a href=http://www.qdp.com>QDP/PLT</a>.

<li>Unpack the software using the command:
<p><ul><li>tar xvfz common5.2linux_pc.tar.gz</ul></p>
A directory named <em>lheasoft</em> will be created.

<li>Read the <em>lheasoft/INSTALL.BINARY</em> file, which gives
   instructions on how to install the precompiled binaries on your
   system. In summary, this file tells you to:
<p><ul> 
<li>cd lheasoft/Linux_2.2_i686/BUILD_DIR/ 
<li>./configure >& config.out &
<li>./hmake install >& install.log & 
</ul></p>

<li>Edit the following lines in the <em>period_start</em> 
script in the <em>period/bin</em> subdirectory:
<p><ul><li>set LHEASOFT_DIR=/home/vsd/progs</ul></p>
<p><ul><li>set PERIOD_DIR=/home/vsd/progs</ul></p>
Replace the <em>/home/vsd/progs</em> strings with the full path to your 
<em>period</em> and <em>lheasoft</em> directories.

<li>Add the following line to your <em>.cshrc</em> file:
<p><ul><li>alias period_start "source /home/vsd/progs/period/bin/period_start"</ul></p>
replacing the <em>/home/vsd/progs</em> string with the full path to 
your <em>period</em> directory.

<li>Source your modified <em>.cshrc</em> file and then type:
<p><ul><li>period_start</ul></p>

<li>Now compile and link PERIOD by typing:
<p><ul><li>make period</ul></p>
in the <em>period/src</em> subdirectory. A <em>period</em> executable 
should now appear in the <em>period/bin</em> subdirectory.

</ol>
</p>

<!------------------------------------------------------------------------->

<hr noshade>
<a name="Initializing and running">
<h2>Initializing and running</h2>

<p>
Every time you open a new xterm you need to initialize PERIOD by typing:
<p><ul><li>period_start</ul></p>
To then run PERIOD, type:
<p><ul><li>period</ul></p>
<font color=red>Note that if you forget to initialize PERIOD before
running it, you may mistakenly end up running the Starlink version
of the program (assuming it has been installed on your system).</font>
</p>

<!------------------------------------------------------------------------->

<hr noshade>
<a name="Data format and storage">
<h2>Data format and storage</h2>

<h3>Reading ASCII files as input</h3>

<p>
The simplest form of input for PERIOD is an ASCII file.  The file may
contain up to a maximum of 99999 rows and 10 columns. It is possible
to specify which column refers to the x-axis, which column refers to
the y-axis and which column refers to the y-axis errors.  The y-axis
errors are optional and if included are used (or handled) by all
operations in the main PERIOD menu (see <a href="#Menu options">Menu
options</a>).  However, the only periodicity-finding option in the
PERIOD_PERIOD sub-menu which actually uses the errors on data points
is CHISQ (see <a href="#Menu options">Menu options</a>).  The
remaining five techniques (CLEAN, FT, PDM, SCARGLE, STRING) ignore
errorbars if they are present. Note also that the input file must
contain x-axis values which are in ascending order, otherwise the
program will report a warning and either sort the data (if requested
to do so) or abort the input.
</p>

<p>
Data is stored and processed within PERIOD using a slot
system.  A data slot is simply an array holding one dataset. The
maximum number of data slots which can be handled at any one time in
PERIOD is 60; hence PERIOD has the capability of analysing a large
amount of data simultaneously.
</p>

<p>
The first command that is usually run in PERIOD is INPUT
(see <a href="#Menu options">Menu options</a>), which loads datasets 
into data slots:
</p>

<p>
<em>
Enter first and last slots for input (0,0 to quit) :
</em>
</p>

<p>
In order to load the first slot with a single dataset, you should reply 
1,1 to the above prompt. Similarly, if you want to load slots
4 through to 9 with 6 datasets, you should reply 4,9 to the above
prompt. It is important to note that slots can be overwritten.
Typing 0,0 will return you to the menu. 
</p>

<p>
Most PERIOD commands prompt not only for an input slot, but also for
an output slot:
</p>

<p>
<em>
Enter first and last slots for input  (0,0 to quit) : <br>
Enter first and last slots for output (0,0 to quit) : 
</em>
</p>

<p>
The input should contain the dataset (or datasets) and the output will
contain the result of the operation on the dataset (or datasets). For
example, given a set of 5 time-series (which have previously been
loaded into slots 1 to 5 using INPUT) which need to be fitted with a
sine curve (using the command FIT, see <a href="#Menu options">Menu
options</a>), you would type 1,5 in reply to the first prompt and 6,10
in reply to the second. PERIOD will then fit sine curves to the data
files loaded in slots 1 to 5 and put the fits in slots 6 to
10. Clearly, the number of output slots must be equal to the number of
input slots. In addition, if any selected input slot is empty, PERIOD
will abort the operation and return you to the main menu. It should be
noted that in order to save on storage space you could have typed 1,5
in reply to the second prompt and the original data-files would have
been overwritten by the resulting sine curves.
</p>

<h3>Reading ULTRACAM files as input</h3>

<p>
It is also possible to use PERIOD to load data from the log files
output by the <em>reduce</em> program of the ULTRACAM pipeline data
reduction system. To do this, it is first necessary to use the UINPUT
option (instead of the INPUT option described above). UINPUT reads in
the log file, automatically skips the headers, and determines the
number of runs and the number of apertures (i.e. stars) on each of
ULTRACAM's three CCDs. As a check, it outputs the first and last MJD
values read from the file and also offers users the option of
viewing both the non-fatal and fatal <em>reduce</em> errors (indicated
by the "** WARNING:" and "** ERROR:" strings, respectively). The error
codes have the following meanings:
</p>

<ul>
<li><b>Error code 1:</b> At least one attempt was made to remove a cosmic ray 
              from the star aperture (non-fatal).
<li><b>Error code 2:</b> Sky annulus overlaps edge of data window (non-fatal).
<li><b>Error code 3:</b> Sky annulus overlaps edge of data window and at least 
              one cosmic ray was zapped (non-fatal).
<li><b>Error code 4:</b> Negative sky values may indicate a bad bias frame 
              which leads to underestimated errors in the photon 
              case (non-fatal).
<li><b>Error code 5:</b> No sky pixels (non-fatal, although could be bad!).
<li><b>Error code 6:</b> Aperture lies outside all data windows (fatal).
<li><b>Error code 7:</b> Target aperture overlaps edge of data window (fatal).
<li><b>Error code 8:</b> Aperture has been invalidated (fatal).
</ul>

<p> 
Note that UINPUT will fail if the number of lines in the log file exceeds
10000 and/or the maximum number of apertures on each CCD exceeds 20.
</p>

<p>
Once ULTRACAM data has been successfully loaded into PERIOD using
the UINPUT command, it is then necessary to run the USLOTS option.  This
routine is essential because a single ULTRACAM data file contains a
great deal of information and the user must select the relevant items
for processing within PERIOD from the following list:
</p>

<ul>
<li><b>x-axis options</b>
</ul>
<ol>
<li><b>MJD -</b>  Modified Julian Date (UTC) at the centre of the exposure, 
          i.e. MJD = JD-2400000.5. No correction for light travel, etc, 
          is made on the basis that the key thing is to have a 
          well-understood, correct time. Note that to preserve the
          timing accuracy without having to resort to double precision,
          the integer part of the first MJD value read from the 
          ULTRACAM input file is currently subtracted from all MJD's in 
          PERIOD. 
<li><b>Run number -</b> The frame number for data from the ULTRACAM .dat 
                  files.
</ol>

<ul>
<li><b>y-axis options</b>
</ul>
<ol>
<li><b>Object counts (with errors) -</b> Estimate of the target counts and
                                   the associated 1-sigma uncertainties.
<li><b>Sky counts -</b> Sky background in counts.
<li><b>x-position of aperture</b>
<li><b>y-position of aperture</b>
<li><b>Number of sky pixels rejected</b>
<li><b>Number of GPS satellites detected -</b> The number of satellites 
                                         associated with the timestamp.
                                         (Not quite true in drift mode).
</ol>

<p>
It is possible to load just one slot containing the light curve (or
the x-position of the aperture, etc) of just one star (i.e. one 
aperture) in one particular filter (i.e. CCD). Alternatively, either 
the light curves of all the stars on one particular CCD, or the light 
curves of a single star on all three CCDs can be loaded. If no data is 
present for a particular CCD (for example, if no light is detected in
the blue channel), then it is only possible to load data for a single 
CCD at a time.
</p>

<p>
Note that the input file MUST contain x-axis values which are in
ascending order.  Because this should always be true if inputting
ULTRACAM data, the user is simply warned to check the input file and
allowed to continue. (The user is not forced to sort the x-axis
data, as occurs when running INPUT).
</p>

<!------------------------------------------------------------------------->

<hr noshade>
<a name="Menu options">
<h2>Menu options</h2>

<p>
Detailed descriptions of the individual PERIOD commands are given
below.  Note that PERIOD also has an extensive in-program help
facility, which provides information at a level of detail similar to
that found below, as well as providing a detailed description of the
individual prompts (something which cannot be found in this section).
</p>

<p>
PERIOD is a menu-driven monolith program. On entering PERIOD, you will
be confronted with the following menu options:
</p>

<p>
<img src=period.gif>
</p>

<p>
Any one of these commands can be entered by typing anything from the
shortest unambiguous string up to the full command name. Therefore, P
would be ambiguous, but PE would not.
</p>

<h3>INPUT</h3>

<p>
As described in <a href="#Data format and storage">Data format and
storage</a>, this option allows you to input ASCII data into
PERIOD. The routine determines the number of columns in the input
files and then prompts the user for which columns refer to the x-axis,
y-axis and y-axis errors (if desired, see <a href="#Data format and
storage">Data format and storage</a>).  For example, if the user is
inputting radial velocity data, the x-axis would most probably be
HJD's, the y-axis the heliocentric radial velocities and there would
most likely be errors associated with each radial velocity value. Note
that the x-axis values must be in ascending order, otherwise INPUT
will report a warning and either sort the data (if requested to do so)
or abort.  Note also that the y-axis errors are used by all options in
the main PERIOD menu, but by only the CHISQ periodicity-finding option
in the PERIOD_PERIOD sub-menu.
</p>

<h3>FAKE</h3>

<p>
Allows you to create fake data with which to test or experiment with
PERIOD.  Two options are catered for: periodic data or chaotic
data. The periodic data are created by summing a user-specified number
of sine curves of the form:
</p>

\begin{quote} {\tt Y = GAMMA + (AMPLITUDE * SIN( ((2.0*PI)/PERIOD) *
(X - ZEROPT)))} \end{quote}

The chaotic data are created using a simple logistic equation of the form:

\begin{quote}
{\tt Xn+1 = LAMBDA * Xn * (1-Xn)} 
\end{quote}

(see, for example, Scargle 1990ab). Values of 4 and 0.125 for LAMBDA
and the initial value of Xn, respectively, work well.

<h3>NOISE</h3>

<p>
Using this option, it is possible to add noise to data or randomize
data. The latter operation is carried out by specifying the [N]ew
dataset option, which will construct an artificial dataset of the same
mean value and the same standard deviation as the original. Selecting
the [O]ld dataset allows you to apply noise to data, create errorbars
on the data points, and/or add noise to the data sampling (so that,
for instance, an evenly sampled dataset becomes unevenly
sampled). This routine is useful, not only in creating realistic
artificial datasets (in conjunction with FAKE), but also in
investigating the effects of noise on a period detection.
</p>

<h3>DETREND</h3>

<p>
This option removes the D.C. bias from data, which if not removed
gives rise to significant power at 0 Hz. There are two options: If the
data show no long term trends, it is best to simply subtract the mean
and divide by the standard deviation (the {\tt [M]} option). This
gives a dataset with a mean of zero and a standard deviation of
one. Otherwise, it is best to subtract a low-order polynomial fit to
the data (the {\tt [P]} option), since if these are not removed, a
Fourier transform will inject a significant amount of power at the
frequency of the long term variations.
</p>

<h3>WINDOW</h3>

<p>
One of the main problems with the {\em classical}
periodogram\footnote{Throughout the {\tt PERIOD} package and this
document, the terms {\em power spectrum} and {\em periodogram} are
used interchangeably, although strictly speaking the power spectrum is
a theoretical quantity defined as an integral over continuous time, of
which the periodogram is merely an estimate based on a finite amount
of discrete data (Scargle 1982).}  (see Scargle 1982 for a
definition), is {\em spectral leakage}, of which there are several
forms. Leakage to nearby frequencies (sidelobes) is due to the finite
total interval over which the data is sampled. Leakage to distant
frequencies is due to the finite size of the interval between
samples. The {\tt WINDOW} option sets all the $y$-axis data points to
unity. A discrete Fourier transform of the resulting data (using, for
example, the {\tt FT} option, see below) yields the window function
(or spectrum), which shows the effects of spectral leakage.
</p>

<h3>OPEN</h3>

<p>
It is possible to store the fits calculated by {\tt SINE} and {\tt
PEAKS} in a log file. This option opens a new log file (if it does not
already exist), or else re-opens an old log file and skips over the
existing entries.
</p>

<h3>CLOSE</h3>

<p>
This option closes the currently open log file. 
</p>

<h3>PERIOD</h3>

<p>
This is where all the work is done. You will be confronted by the
following sub-menu:
</p>

<p>
<img src=period_period.gif>
</p>

<h3>SELECT</h3>

<p>
Selects input and output slots for processing, as described in
section~\ref{slots}. The input slots should contain the time-series,
the output slots will contain, for example, the power spectra.  {\tt
SELECT} must be run {\em every} time a periodicity-finding option is
about to be executed; although tedious, this prevents one from
accidentally overwriting slots.
</p>

<h3>FREQ</h3>

<p>
Sets the frequency search parameters. The minimum frequency, maximum
frequency and frequency interval can be selected by you. Note that the
maximum number of frequencies is 10000, so the search parameters
should be selected accordingly. Alternatively, by entering 0's,
default values can be accepted. Note that the default values are set
on entering the {\tt PERIOD} package and thus the {\tt FREQ} option
need not be run if default frequencies are required. The default
values are calculated as follows: minimum frequency = 0 (ie. infinite
period), maximum frequency = 1 / (2 $\times$ Smallest Data Interval)
(ie. Nyquist), frequency interval = 1 / (4 $\times$ Total Time
Interval). Note that the default values could demand greater than
10000 frequencies, in which case you will have to modify them.
</p>

<h3>CHISQ</h3> 

<p>
This is a straight-forward technique where the input data is folded on
a series of trial periods. At each trial period, the data is fitted
with a sine curve. The resulting reduced-$\chi^2$ values are plotted
as a function of trial frequency and the minima in the plot suggest
the most likely periods. See Horne, Wade and Szkody (1986) for an
example of the use of this method, which is ideally suited to the
study of radial velocity data or any other sinusoidal variations. Note
that windowed data cannot be processed by this option since no sine
fit is possible.
</p>

<h3>CLEAN</h3>

<p>
The {\tt CLEAN} algorithm was originally developed for use in aperture
synthesis and was later applied to one-dimensional data by Roberts,
Leh\'{a}r and Dreher (1987). An adapted version of Leh\'{a}r's code is
used here, and is particularly useful for unequally spaced data. The
algorithm basically deconvolves the spectral window from the discrete
Fourier power spectrum (or dirty spectrum). This produces a {\tt
CLEAN} spectrum, which is largely free of the many effects of spectral
leakage. In order to prevent small errors from destabilizing the {\tt
CLEAN} procedure, the user is prompted for two parameters -- the loop
gain and the number of iterations. Briefly, with each iteration, some
fraction (governed by the loop gain) of the window function is removed
from the dirty spectrum. For convergence, the loop gain must lie
between 0 and 2, typical values being between 0.1 and 1. Values at the
bottom of this range require more iterations, but should provide more
stability.  Hence, the number of iterations should be large if the
loop gain is small, typical values lying between 1 and 100. Note that
an increase in the number of cleans produces a less noisy spectrum
but, in general, the amplitude of the peaks is decreased, sometimes by
a substantial amount. See Roberts, Leh\'{a}r and Dreher (1987) for
further details on choosing these parameters.
</p>

<h3>FT</h3>

<p>
This option performs a classical discrete Fourier transform on the
data and sums the mean-square-amplitudes of the result to form a power
spectrum (see, for example, Deeming 1975). This discrete Fourier
transform is defined for arbitrary data spacing and is equal to the
convolution of the true Fourier transform with a spectral
window. Hence, the effects of data spacing, such as aliasing, are all
contained in the spectral window, which can be generated using the
{\tt WINDOW} option (see above). This spectral window should be
analysed in conjunction with the discrete Fourier transform generated
here in order to estimate the effects of aliasing.
</p>

<h3>PDM</h3>

<p>
The phase dispersion minimization (PDM) technique is simply an
automated version of the classical method of distinguishing between
possible periods, in which the period producing the least
observational scatter about the mean light curve (or, for example,
radial velocity curve) is chosen. This technique (which is described
in detail by Stellingwerf 1978) is well suited to cases in which only
a few observations are available over a limited period of time,
especially if the light curve is highly non-sinusoidal. The data is
first folded on a series of trial frequencies. For each trial
frequency, the full phase interval (0,1) is divided into a
user-specified number of bins. The width of each bin is specified by
the user, such that a point need not be picked (if a bin width
narrower than the bin spacing is selected) or a point can belong to
more than one bin (if a bin width wider than the bin spacing is
selected). The variance of each of these bins (or samples) is then
calculated. This gives a measure of the scatter around the mean light
curve defined by the means of the data in each sample. The PDM
statistic can then be calculated by dividing the overall variance of
all the samples by the variance of the original (unbinned)
dataset. This process is then repeated for the next trial
frequency. Note that windowed data cannot be passed to this option
since its variance is zero. If the trial period is not a true period,
then the overall sample variance will be approximately equal to the
variance of the original dataset (ie. the PDM statistic will be
approximately equal to 1). If the trial period is a correct period,
the PDM statistic will reach a local minimum compared with
neighbouring periods, hopefully near zero.
</p>

<h3>SCARGLE</h3>

<p>
By redefining the classical periodogram (ie. the discrete Fourier
periodogram) in such a manner as to make it invariant to a shift of
the origin of time, Lomb (1976) and Scargle (1982) developed a novel
type of periodogram analysis, quite powerful for finding, and testing
the significance of, weak periodic signals in otherwise random, {\em
unevenly sampled} data. Horne and Baliunas (1986) have elaborated on
the method and Press and Rybicki (1989) present a fast implementation
of the algorithm, a modified version of which is used here. This
implementation uses FFTs to increase the speed of computation
(although it is in no way equivalent to conventional FFT periodogram
analysis). Note that windowed data cannot be passed to this option
since it needs to calculate the variance (which is zero) to normalize
the power of the periodogram.
</p>

<h3>STRING</h3>

<p>
The string-length method is an intuitively simple method, described in
detail by Dworetsky (1983) and Friend {\it et al.} (1990). The data is
folded on a series of trial periods and at each period the sum of the
lengths of line segments joining successive points (the string-length)
is calculated. Minima in a plot of string-length versus trial
frequency indicate possible periods. The string-length method is
especially useful in the limit of a very small number (about 20 or
more) of randomly spaced observations of periodic phenomena. Note that
windowed data cannot be passed to this option due to the $y$-data
scaling process (see Dworetsky 1983).
</p>

<h3>PEAKS</h3>

<p>
This option should be run once a periodogram has been obtained. It
finds the highest peak in the periodogram (or lowest trough if it is a
string-length, PDM or reduced-$\chi^2$ plot) between user-specified
frequencies. The resulting period is calculated, along with an
error. Errors on period detections are notoriously difficult to
estimate. The estimate used in the previous version of {\tt PERIOD}
(v3.0) employed a formula derived by Kovacs (1981). The derivation
assumed a single signal, Gaussian noise and even data spacing. This is
clearly not the case with most astronomical datasets and the formula
is hence of little use (see Horne and Baliunas 1986).
Schwarzenberg-Czerny (1991) presents a detailed account of the
accuracy of period determinations and advises a {\em post-mortem}
analysis by measuring the width and heights of peaks in a
periodogram. Although virtually impossible to automate, it is possible
to do this manually from within {\tt PERIOD} using the fitting
routines of {\tt QDP/PLT} (see above). Therefore, for the sake of
generality and to avoid uncertainties, version 4.0 of {\tt PERIOD} now
only outputs an error derived by calculating the half-size of a single
frequency bin, centred on the peak (or trough) in a periodogram, and
then converting to period units. This error gives an indication of the
accuracy to which a peak can be located in a periodogram (due to the
frequency sampling). Clearly, with a larger frequency search interval
it is more difficult to locate a peak precisely and this is reflected
in the error estimate. However, this error estimate does not take into
account the fact that the peak (or trough) may not represent the true
period (which can be shifted due to a number of effects) and it should
therefore be regarded as a {\em minimum} error and not a formal error.
</p>

<p>
If the significance calculation is enabled (with the {\tt SIG}
command, see below), two false alarm probabilities are quoted
alongside the period. The first ({\tt FAP1}) is the probability that,
given the frequency search parameters, there is no periodic component
present in the data with this period. The second ({\tt FAP2}) is the
probability that the period is not actually equal to the quoted value
but is equal to some other value. Note that FAP1 is only output if the
whole frequency range is specified to be analysed in {\tt PEAKS} (see
below). One sigma errors on both significance values are also
given. If the significance values are zero, these errors are displayed
as --1, implying that the false alarm probabilities lie between 0.00
and 0.01 with 95\% confidence. Clearly, the lower a significance value
and its error, the more likely the quoted period is a correct one. If
both the significances and errors are displayed as --1, this means
that the input periodogram has not been subjected to a significance
calculation (ie. the significance calculation has been disabled). Note
that the results can be written to a log file if one is open. For more
information on the {\tt SIG} option, see below. For useful discussions
on errors and significances of period determinations, see
Schwarzenberg-Czerny (1991) and Nemec and Nemec (1985).
</p>

<h3>SIG</h3>

<p>
This option works as a switch, either turning on or turning off the
significance calculation. The default on entering {\tt PERIOD} is for
the significance calculation to be disabled. This means that no
significance values are calculated or attached to period
determinations. By typing {\tt SIG}, the significance calculation is
enabled. You are first prompted for the number of permutations in the
sample. To ensure reliable significance values, the minimum number of
permutations is set to 100. You are then prompted for a seed for the
random number generator -- this number determines the starting point
in a number series of infinite period. Therefore, entering the same
seed on two calls to {\tt SIG} will result in the same sequence of
random numbers.  If {\tt SIG} is already enabled, one can disable the
significance calculation by typing {\tt SIG} again.
</p>

<p>
With the significance calculation enabled, every time a period-finding
option is run ({\tt CHISQ, FT, SCARGLE, CLEAN, STRING, PDM}) a Fisher
randomization test is performed (see, for example, Nemec and Nemec
1985). This consists of calculating the periodogram as usual and
loading the specified output slot. The $y$-axis data is then shuffled
to form a new, randomized time-series. The periodogram of this dataset
is then calculated (but not stored in the output slot, which will
always contain the periodogram of the real time-series). This
randomization and periodogram calculation loop is then performed for
the number of permutations specified by the user. This can take a
considerable amount of time, depending on the number of data points in
the time-series, the frequency search parameters and the number of
permutations.
</p>

<p>
Once the loop is complete, you should enter the {\tt PEAKS} option to
view the resulting significances. Two significance estimates are given
in {\tt PEAKS}.  The first, denoted {\tt FAP1}, represents the
proportion of permutations (ie.  shuffled time-series) that contained
a trough lower than (in the case of the {\tt CHISQ, STRING} and {\tt
PDM} options) or a peak higher than (in the case of the {\tt FT,
SCARGLE} and {\tt CLEAN} options) that of the periodogram of the
unrandomized dataset {\em at any frequency}. This therefore represents
the probability that, given the frequency search parameters, no
periodic component is present in the data with this period and it is
only output in {\tt PEAKS} if the whole frequency range is specified
to be analysed. The second significance, denoted {\tt FAP2},
represents the proportion of permutations that, {\em at the frequency
given by the period output by} {\tt PEAKS}, contained troughs lower
than (or peaks higher than) the peak or trough in the periodogram of
the real dataset. This therefore represents the probability that the
period is not actually equal to the quoted value but is equal to some
other value, and is quoted for any frequency range specified in {\tt
PEAKS}. Standard errors on both of these false alarm probabilities are
also given (see Nemec and Nemec 1985).
</p>

<p>
It is perhaps worth mentioning here that significance estimates of
period detections are notoriously unreliable. The methods used in the
previous version of {\tt PERIOD} (v3.0) suffered from a number of
problems. For example, the F-test used with the {\tt PDM} method
(Stellingwerf 1978) has been proved to be incorrect (see, for example,
Heck, Manfroid and Mersch 1985). Similarly, the theoretical minimum
string-lengths quoted by Dworetsky (1983) are misleading, since they
are based on evenly-spaced functions and it is possible to obtain
values below this even for pure noise data with certain data
spacings. The well-known {\tt SCARGLE} false alarm probabilities are
also incorrect, since the Horne and Baliunas (1986) equation for the
number of independent frequencies has been shown to be incorrect
(Christian Knigge (Oxford), private communication). Even if correct,
the Horne and Baliunas formula would be incorrect to apply in a
general way since it is a poor approximation to small datasets. The
only reliable method of estimating significances from such
non-parametric tests is by some sort of Monte Carlo or randomization
method.  As described above, one such method (Fisher randomization)
has been implemented in this version of {\tt PERIOD} (v4.0) following
the prescription described by Nemec and Nemec (1985).
</p>

<h3>HELP</h3>

<p>
This command provides on-line help for {\tt PERIOD}.  Detailed
information about individual commands can be obtained by typing {\tt
HELP 'COMMAND'} (eg. {\tt HELP PEAKS}).
</p>

<h3>QUIT (or EXIT)</h3>

<p>
This quits the \verb@PERIOD_PERIOD@ sub-menu and returns the user to
the main {\tt PERIOD} menu.
</p>

<p>
Returning to the main {\tt PERIOD} menu:
</p>

<h3>FIT</h3>

<p>
Folds the data on a given period and zero point and then fits the data
with a sine curve. The sine curve has the form: {\tt Y = GAMMA +
(AMPLITUDE * SIN( ((2.0*PI)/PERIOD) * (X - ZEROPT) ))}. Outputs the
fit parameters (which can be written to a log file) and the resulting
sine curve.
</p>

<h3>FOLD</h3>

<p>
Folds the data on a given period and zero point. Hence, this option
transforms the data onto a phase scale, where one phase unit is equal
to one period and phase zero is defined by the zero point. If the zero
point is not known, the data can be folded by taking the first data
point as the zero point. This option is useful for checking whether
derived periods actually give sensible results when applied to the
data. In addition to normal folding, it is also possible to phase bin
the data, which folds the data and then averages all the data points
falling into each bin.
</p>

<h3>SINE</h3>

<p>
Adds, subtracts, multiplies or divides a sine curve from data. The
sine curve has the form: {\tt Y = GAMMA + (AMPLITUDE * SIN(
((2.0*PI)/PERIOD) * (X - ZEROPT) ))}. This option is useful for
removing or adding known periods from/to data, thus enabling or
testing the detection of other periods.
</p>

<h3>PLT</h3>

<p>
This routine calls PGPLOT routines to display the graphs of the slots
requested. The layout of the displays is fixed but output file types
such as landscape postscript files can be created. This represents
slightly less functionality than the original XANADU based QDP {\tt
PLT} routine, but no QDP {\tt PLT} routine is currently available for
LINUX.
</p>

<p>
In order to receive on-line help, simply type {\tt HELP} at the {\tt
PERIOD-PLT} prompt. To exit {\tt PERIOD-PLT} and return to the {\tt
PERIOD} menu, type {\tt EXIT}.
</p>

<h3>STATUS</h3>

<p>
Returns information on the data slots or on the stored fits in the log
file.  This command is useful in order to check which slots contain
which datasets and also as a means of obtaining some elementary
statistics on the stored data.  You can also use this option to check
the fits from the {\tt SINE} and {\tt PEAKS} options stored in the log
file without having to exit the package and read the log file.
</p>

<h3>OUTPUT</h3>

<p>
Writes any selected slot to an ASCII file on disk. This is the only
way of saving data created by {\tt PERIOD} (it does not write to {\tt
FITS} files), and should therefore be run before {\tt QUIT}ing in
order to store, say, a power spectrum.
</p>

<h3>HELP</h3>

<p>
This command provides on-line help for {\tt PERIOD}. Detailed
information about individual commands can be obtained by typing {\tt
HELP 'COMMAND'} (eg. {\tt HELP PERIOD}).
</p>

<h3>QUIT (or EXIT)</h3>

<p>
This option quits a {\tt PERIOD} session. However, it does provide a
last chance to stay in the package. This is essential to prevent
accidental exit, since any data files created using {\tt PERIOD} will
be lost on exit from the package {\em unless} one {\tt OUTPUT}s the
data first.
</p>

<!------------------------------------------------------------------------->

<hr noshade>
<a name="A simple recipe">
<h2>A simple recipe</h2>

<p>
A simple guide designed to introduce inexperienced users to the steps
involved in detecting periodicities is outlined below. Detailed
descriptions of the individual PERIOD commands can be found in <a
href="#Menu options">Menu options</a> and in the program's help facility
(which also gives help on the individual prompts one is confronted
with).
</p>

<ol>
<li> Create an ASCII data file containing the time-series.
<li> Read ASCII data into PERIOD using INPUT. 
<li> Detrend the data using the M option in DETREND (if the
data show long term variations, use the P option instead).
<li> Open a log file for the fits using OPEN. 
<li> Enter the PERIOD_PERIOD menu by typing PERIOD.
<li> Select the slots which contain the time-series data and specify the output
slots for the periodograms using SELECT.
<li> Set the frequency search limits using FREQ. If you have no idea
what the period is, accept the default values by typing 0 (or alternatively, 
by not typing FREQ in the first place). 
<li> Enable the significance calculation by typing SIG and specifying,
say, 100 permutations.
<li> Calculate the Lomb-Scargle periodogram by typing SCARGLE.
<li> Now run PEAKS on the resulting periodogram, specifying the
frequency range which contains the peak you wish to measure (you may enter 0,0
if you wish to process the entire range). Write the results to the log file.
<li> Now reselect the time-series slots and different output slots for a new
periodogram using SELECT.
<li> Type CLEAN with 5 iterations and a loop gain of 0.2, for example.
(Before doing this, you may wish to disable the significance calculation by 
typing SIG again, since the CLEAN algorithm can take a 
considerable amount of processing time).
<li> Run PEAKS on the resulting periodogram and store the results.
<li> Now quit the PERIOD_PERIOD sub-menu by typing QUIT.
<li> Plot the periodograms using PLT. Check to see the validity of the
highest peak selected.
<li> Check the results in the log file using STATUS. In particular, look
closely at the false alarm probabilities.
<li> Fold the original data on the most likely period using FOLD.
<li> Plot the folded data using PLT. If this looks sensible, the period
may well be correct. 
<li> Output the periodograms and folded data to an ASCII file on disk
using OUTPUT.  
<li> Exit PERIOD by typing QUIT.  
</ol>

<p>
The above description is intended only as a very brief guide. Clearly,
a great deal more experimentation is required before it can definitely
be said that a period has been detected. For example, you should look
at the window function, investigate other large peaks in the
periodogram, try smaller or larger frequency ranges, or try one of the
other periodicity-finding options (a useful comparison of a number of
different techniques is given by Carbonell, Oliver and Ballester 1992
and Heck, Manfroid and Mersch 1985). Other analysis techniques might
also be attempted, such as subtracting a sine curve from the data in
order to investigate its effects on the harmonics and enable the
detection of less-dominant periods.
</p>

<!------------------------------------------------------------------------->

<hr noshade>
<a name="References">
<h2>References</h2>

<p>
<ul>
<li>Canizzo J & Goodings D, 1986, ApJL, 334, L31
<li>Carbonell M, Oliver R & Ballester J L, 1992, A&A, 264, 350
<li>Deeming T J, 1975, Ap&SS, 36, 137
<li>Dworetsky M M, 1983, MNRAS, 203, 917
<li>Fahlman G G & Ulrych T J, 1982, MNRAS, 199, 53
<li>Friend M T, Martin J S, Smith R C & Jones D H P, 1990, MNRAS, 246, 637
<li>Heck A, Manfroid J & Mersch G, 1985, A&AS, 59, 63
<li>Horne J H & Baliunas S L, 1986, ApJ, 302, 757
<li>Horne K, Wade R A & Szkody P, 1986, MNRAS, 219, 791
<li>Kovacs G, 1981, Ap&SS, 78, 175
<li>Lehto H J, Czerny B & McHardy I M, 1993, MNRAS, 261, 125
<li>Lomb N R, 1976, Ap&SS, 39, 447
<li>Nemec A F L & Nemec J M, 1985, AJ, 90, 2317
<li>Press W H & Rybicki G B, 1989, ApJ, 338, 277
<li>Roberts D H, Lehar J & Dreher J W, 1987, AJ, 93, 968
<li>Scargle J D, 1982, ApJ, 263, 835
<li>Scargle J D, 1990a, ApJ, 359, 469
<li>Scargle J D, 1990b, Errors, Bias & Uncertainties in Astronomy, Jaschek C & Murtagh F, CUP, Cambridge
<li>Schwarzenberg-Czerny A, 1989, MNRAS, 241, 153
<li>Schwarzenberg-Czerny A, 1991, MNRAS, 253, 198
<li>Stellingwerf R F, 1978, ApJ, 224, 953
</ul>
</p>

<!------------------------------------------------------------------------->

<hr noshade>

</body>
</html>
